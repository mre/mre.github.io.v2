<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
    ﻿html,body,div,form,fieldset,legend,label,h1{margin:0;padding:0}table{border-collapse:collapse;border-spacing:0}th,td{text-align:left;vertical-align:top}h1,h2,h3,h4,h5,h6,th,td,caption{font-weight:normal}img{border:0;max-width:100%}h1{font-size:1.87em}h2{font-size:1.2em;margin-bottom:10px;margin-top:0}h3{margin-top:50px}body{background-color:#fff;color:rgba(0,0,0,.8);font-family:medium-content-serif-font,Georgia,Cambria,"Times New Roman",Times,serif;-moz-font-feature-settings:"liga" on;font-feature-settings:"liga" on;font-size:1.25em;-moz-osx-font-smoothing:grayscale;font-style:normal;font-weight:400;letter-spacing:-0.003em;line-height:1.58;text-rendering:optimizeLegibility}article{margin-top:44px}pre{-moz-font-feature-settings:"liga" off;font-feature-settings:"liga" off;font-size:.92em;-moz-osx-font-smoothing:auto;-webkit-font-smoothing:subpixel-antialiased;padding:20px;overflow:auto}::-moz-selection{background:#000;color:#fff}::selection{background:#000;color:#fff}body{margin-top:8%}header{font-size:.78em;margin:0 auto 2em;max-width:220px;text-align:center}a:link,a:visited,a:hover,a:active{color:#af403c;text-decoration:none}a:hover{text-decoration:underline}nav{text-align:center}nav ul{display:inline-block;text-align:initial;padding-left:0}nav li:not(:first-child):before{content:" · "}nav li{list-style:none;display:inline}.logo{background-size:cover;display:inline-block;height:150px;width:171px}.published-date{color:#888;font-size:.8em}blockquote{border-left:4px solid #ededee;font-style:italic;margin:4px 10px;padding:3px 20px}code{background-color:#f9f9fa;border:1px solid #ededee;border-radius:6px;display:inline-block;font-family:"Courier New","Courier",monospace;-moz-font-feature-settings:"liga" off;font-feature-settings:"liga" off;font-size:16px;-moz-osx-font-smoothing:auto;-webkit-font-smoothing:subpixel-antialiased;max-width:100%;overflow-x:auto;padding:0 5px;vertical-align:middle;word-wrap:normal;box-shadow:0 1px 1px rgba(0,0,0,.125)}.button{background-color:#af403c;border-radius:10px;color:#fff;margin:40px auto;padding:10px;text-align:center}.button:hover{background-color:red}.talk{margin-top:80px}.video-container{position:relative;padding-bottom:56.25%;padding-top:30px;height:0;overflow:hidden;margin-bottom:40px}.video-container iframe,.video-container object,.video-container embed{position:absolute;top:0;left:0;width:100%;height:100%}figure{font-size:.9em;font-style:italic;margin:0 0 40px;padding:0;text-align:center;text-indent:0}figcaption{margin-top:10px}.loader{position:relative;overflow:hidden;width:auto}.loader object{position:absolute}.loader img,.loader object{display:block;top:0;left:0;width:100%}object{position:relative;float:left;display:block}object::after{position:absolute;top:0;left:0;display:block;width:1000px;height:1000px;content:"";background:#efefef}.frozen{-webkit-filter:blur(8px);-moz-filter:blur(8px);-o-filter:blur(8px);-ms-filter:blur(8px);filter:blur(8px);transform:scale(1.04);animation:.2s ease-in .4s 1 forwards fade;width:100%}@keyframes fade{0%{opacity:1}100%{opacity:0}}@media(max-width: 520px){body{padding:0 20px}pre{font-size:.85em;padding:5px}h1{font-size:1.6em}}@media(min-width: 520px){body{margin:10% auto 0;margin-top:120px;width:480px}h1{font-size:1.6em}}@media(min-width: 1024px){body{width:850px}header{float:left;width:210px}main,footer{margin-left:260px;margin-bottom:40px}}footer{margin-bottom:40px}.links{list-style:none;display:inline}.field{padding:10px;font-size:.8em}.email{width:300px}.submit{border:none;padding:12px;background-color:#eee}

    </style>
    <link rel="dns-prefetch" href="//www.google-analytics.com/" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=m2llJQPQq8">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=m2llJQPQq8">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=m2llJQPQq8">
    <link rel="manifest" href='data:application/manifest+json,
    { "short_name": "Endler",
    "icons": [
        {
            "src": "/android-chrome-192x192.png?v=m2llJQPQq8",
            "sizes": "192x192",
            "type": "image/png"
        },
        {
            "src": "/android-chrome-512x512.png?v=m2llJQPQq8",
            "sizes": "512x512",
            "type": "image/png"
        }
    ]
    }' />
    <link rel="mask-icon" href="/safari-pinned-tab.svg?v=m2llJQPQq8" color="#5bbad5">
    <link rel="shortcut icon" href="/favicon.ico?v=m2llJQPQq8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ffffff">


<meta property="og:title" content="Making Myself Obsolete" />
<meta property="og:type" content="website" />
<meta property="og:description" content="In December 2015 I was looking for static analy..." />
<meta property="og:url" content="https://matthias-endler.de/2017/obsolete" />
<meta property="og:image" content="https://matthias-endler.de/img/social/2017_obsolete.png" />

<meta name="twitter:title" content="Making Myself Obsolete">
<meta name="twitter:description" content="In December 2015 I was looking for static analy...">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@matthiasendler">
<meta name="twitter:creator" content="@matthiasendler">
<meta name="twitter:image" content="https://matthias-endler.de/img/social/2017_obsolete.png">

    
      
        <title>Making Myself Obsolete - Writing a Linter for Linting Linters | Matthias Endler</title>
      

    <meta name="author" content="Matthias Endler">
    <meta name="description" content="Personal website of Matthias Endler, a Software Engineer interested in low-level programming and backend development. PHP, Python, Go, Rust."/>
  </head>
  <body>
        <header>
            <a class="logo" href="/"><img alt="Home" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA3OTAuMjMgNjkyLjYxIj48Y2lyY2xlIGN4PSI0MTMuMjQiIGN5PSIyMjcuNyIgcj0iMjE5LjY4IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMTYuMDMiIHN0eWxlPSJsaW5lLWhlaWdodDoxMjUlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgbGV0dGVyLXNwYWNpbmc9IjAiIHdvcmQtc3BhY2luZz0iMCIvPjxnIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjYTE2MjAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgbGV0dGVyLXNwYWNpbmc9IjAiIHdvcmQtc3BhY2luZz0iMCI+PHBhdGggZmlsbD0iIzMzMWYwMCIgc3Ryb2tlLXdpZHRoPSIxLjk3IiBkPSJNNDgzLjc1IDI2NS43NGwtNjcuMDcgNDAuMTQtNzQuMjMtMzkuNTMgMTQxLjMtLjZ6IiBzdHlsZT0ibGluZS1oZWlnaHQ6MTI1JSIvPjxwYXRoIGZpbGw9IiNlZmJhMDAiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTQ4Ni42NSAyNjUuOTJsLTcwLjIgMzQuMDItNzYuOS0zMy45IDE0Ny4xLS4xMnoiIHN0eWxlPSJsaW5lLWhlaWdodDoxMjUlIi8+PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE2OC42NCAyLjkxNCkgc2NhbGUoLjY1Nzk1KSIgc3R5bGU9ImxpbmUtaGVpZ2h0OjEyNSUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIj48ZWxsaXBzZSBjeD0iLTYwOC43NSIgY3k9Ii0xNjMuMTQiIHRyYW5zZm9ybT0ibWF0cml4KDEuMjQ4OTcgLS4xMTM3IC4xMDcgMS4xNzUxNyAxMDk1Ljg3IDQ2Ni43KSIgcng9IjI1LjI1IiByeT0iMjgiLz48ZWxsaXBzZSBjeD0iMzMxLjM2IiBjeT0iMzQ3Ljk5IiBmaWxsPSIjZmZmIiB0cmFuc2Zvcm09Im1hdHJpeCguNTIyMTMgMCAwIC41NDc0NSAxNTguNzU3IDEzNi40MzIpIiByeD0iMTUuMTUiIHJ5PSIxNy4wNCIvPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjguNjQgMi45MTQpIHNjYWxlKC42NTc5NSkiIHN0eWxlPSJsaW5lLWhlaWdodDoxMjUlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgbGV0dGVyLXNwYWNpbmc9IjAiIHdvcmQtc3BhY2luZz0iMCI+PGVsbGlwc2UgY3g9Ii02MDguNzUiIGN5PSItMTYzLjE0IiB0cmFuc2Zvcm09Im1hdHJpeCgxLjI0ODk3IC0uMTEzNyAuMTA3IDEuMTc1MTcgMTIwMy4yIDQ2Ny42NDYpIiByeD0iMjUuMjUiIHJ5PSIyOCIvPjxlbGxpcHNlIGN4PSIzMzEuMzYiIGN5PSIzNDcuOTkiIGZpbGw9IiNmZmYiIHRyYW5zZm9ybT0ibWF0cml4KC41MjIxMyAwIDAgLjU0NzQ1IDI2NS4zNTggMTM2Ljk5MykiIHJ4PSIxNS4xNSIgcnk9IjE3LjA0Ii8+PC9nPjxnIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjMDAwIj48cGF0aCBkPSJNMzY2LjQgMTAwLjY0YzE4LjU0LTExLjA1IDM2LjU0LTIyLjU3IDQ2Ljk0LTQwLjczIDEuMzUgMTIuMy0uMSAyOC41LTEwLjg2IDQzLjUiLz48cGF0aCBkPSJNMzg5LjQ0IDEwMC42NGMxOC41NC0xMS4wNSAzNi41NC0yMi41NyA0Ni45NC00MC43MyAxLjM1IDEyLjMtLjEgMjguNS0xMC44NiA0My41Ii8+PHBhdGggZD0iTTQxMi40OCAxMDAuNjRDNDMxLjAyIDg5LjYgNDQ5IDc4LjA3IDQ1OS40MiA1OS45YzEuMzUgMTIuMy0uMSAyOC40NC0xMC44NiA0My40NiIvPjwvZz48cGF0aCBkPSJNNDA5LjI0IDg3LjA1Yy04MS44NS4yNy0xNTYuNDQgMTA0LjQzLTE4MC40OCAyMTYuNDZhMTk5LjYgMTk5LjYgMCAwIDAgNTEuODMgNzMuMWM3LjktMTU3LjkgNDQuNy0yNjYuOSAxMTIuNS0yMDcuOCAxMC4xIDguOSAxNS4yIDEyLjkgMjAuMSAxMi42IDQuOS4zIDEwLTMuOCAyMC4xLTEyLjYgNjcuNy01OS4xIDEwNC42IDUwIDExMi41IDIwNy44YTE5OS42IDE5OS42IDAgMCAwIDUxLjgtNzIuOWMtMjQtMTEyLTk4LjYtMjE2LjMtMTgwLjUtMjE2LjUtMS4zOCAwLTIuNy4xLTQgLjEtMS4zOCAwLTIuNy0uMS00LS4xeiIgc3R5bGU9ImxpbmUtaGVpZ2h0OjEyNSUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIi8+PHBhdGggZmlsbD0iIzk1OTU5NSIgZD0iTTEzMS4zIDY5Mi42aDExLjRsLTIwLjkyLTEzOC4zSDEwOS41TDg4LjYgNjkyLjZIMTAwbDUuODgtNDUuOGgxOS4zNnptLTI0LjItNTQuOTZsOC40Ni02NC4zIDguNDcgNjQuM3ptODIuMDUtODMuMzRIMTQ4djEwLjczaDE0Ljg3VjY5Mi42aDExLjRWNTY1LjA0aDE0Ljg4eiIgc3R5bGU9ImxpbmUtaGVpZ2h0OjEyNSU7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonRXZlciBBZnRlciwgTm9ybWFsJzt0ZXh0LWFsaWduOnN0YXJ0IiBmb250LWZhbWlseT0iRXZlciBBZnRlciIgbGV0dGVyLXNwYWNpbmc9IjAiIHdvcmQtc3BhY2luZz0iMCIvPjxwYXRoIGZpbGw9IiM5NTk1OTUiIGQ9Ik0yMjguNjUgNTU0LjNIMTg3LjV2MTAuNzNoMTQuODdWNjkyLjZoMTEuNFY1NjUuMDRoMTQuODh6bTQ0LjkgMHY2MS4zOEgyNDUuMlY1NTQuM2gtMTEuNDJ2MTM4LjNoMTEuNHYtNjYuMzhoMjguMzZ2NjYuNGgxMS4yM1Y1NTQuM3ptMzcuOCAxMzguM2gtMTEuNFY1NTQuM2gxMS40em01Ny42NSAwaDExLjRsLTIwLjkyLTEzOC4zSDM0Ny4ybC0yMC45IDEzOC4zaDExLjRsNS44Ny00NS44aDE5LjM2em0tMjQuMjItNTQuOTZsOC40Ny02NC4zIDguNDcgNjQuM3oiIHN0eWxlPSJsaW5lLWhlaWdodDoxMjUlOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0V2ZXIgQWZ0ZXIsIE5vcm1hbCc7dGV4dC1hbGlnbjpzdGFydCIgZm9udC1mYW1pbHk9IkV2ZXIgQWZ0ZXIiIGxldHRlci1zcGFjaW5nPSIwIiB3b3JkLXNwYWNpbmc9IjAiLz48cGF0aCBkPSJNNTE3LjI2IDU2NS4wM1Y1NTQuM2gtMzEuNjR2MTM4LjNoMzEuNjR2LTEwLjdoLTIwLjIzdi01NS43aDE4Ljg1di0xMC41NGgtMTguODVWNTY1em0xMS4yNC0xMC43M3YxMzguM2gxMS4zNVY1NTQuM0g1MjguNXptMzkuNzYgMHY1MS44N2wtLjEtLjE3djIwLjc1bC4xLjE3djY1LjdoMTEuMjRWNTU0LjNoLTExLjI0em00MC4yNCAwaC0xMy44djEzOC4zaDEzLjgzcTIyLjMgMCAyOS41Ny0yMi40NiA0LjE1LTEzLjMyIDQuMTUtNDYuNjh0LTQuMTUtNDYuNjdxLTcuMjYtMjIuNS0yOS41Ni0yMi41em0tMS4yIDEyNy42aC0xLjJWNTY1LjAyaDEuMnExNS43MyAwIDIwLjU3IDE4LjUgMy4xIDExLjA2IDMuMSAzOS45MyAwIDI4Ljg3LTMuMSAzOS45My00Ljg0IDE4LjUtMjAuNTcgMTguNXptNjAuMjQgMFY1NTQuM2gtMTEuNHYxMzguM2gzMS42MnYtMTAuN3ptNjIuMS0xMTYuODdWNTU0LjNINjk4djEzOC4zaDMxLjYzdi0xMC43SDcwOS40di01NS43aDE4Ljg1di0xMC41NEg3MDkuNFY1NjV6bTYwLjUgMTI3LjU3cS0xNC4xNy0zNy0yMC43NC03Mi4yNSAxNC4xNy0xMC4zNyAxNC4xNy0zMy44OCAwLTMyLjE2LTI3LjQ4LTMyLjE2aC0xNS4zdjEzOC4zaDExLjR2LTY1cTIuMi0uNSA2LjktMiA3IDMzLjQgMTguMyA2Ny4xem0tMzcuODYtNzguNDd2LTQ5LjFoMi42cTEwLjU0IDAgMTQuNyA1Ljg4IDMuMjcgNC43IDMuMjcgMTUuNiAwIDE1LjgtOC4xMiAyMy40LTUuMiA0LjktMTAuMiA0LjktMS4zOCAwLTIuMjUtLjV6IiBzdHlsZT0ibGluZS1oZWlnaHQ6MTI1JTstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidFdmVyIEFmdGVyLCBOb3JtYWwnO3RleHQtYWxpZ246c3RhcnQiIGZvbnQtZmFtaWx5PSJFdmVyIEFmdGVyIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIi8+PHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2Utd2lkdGg9IjEwIiBkPSJNNTM1LjA2IDU1NS43MmwzOCAxMzUuNTQiLz48cGF0aCBmaWxsPSIjOTU5NTk1IiBkPSJNLjEgNTU0LjZ2MTM4aDExLjM4VjU3NS42NWM2LjYgMTIuNyAxMy43OCAyNS45IDE5LjY3IDM2Ljc4bDUuNyAxMCAuMDItLjAydi4xbDUuNzItMTBjNi41LTEyIDEzLjUtMjUuMiAxOS43LTM2Ljh2MTE2LjloMTEuMnYtMTM4SDYyLjNDNTUgNTY4IDQ3LjUgNTgyIDQwLjggNTk0LjRsLTQgNy40NWMtOS4xLTE3LjA1LTE3LjMtMzIuMDctMjUuNC00Ny4yM3oiIHN0eWxlPSJsaW5lLWhlaWdodDoxMjUlOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J0V2ZXIgQWZ0ZXIsIE5vcm1hbCc7dGV4dC1hbGlnbjpzdGFydCIgZm9udC1zaXplPSIxNzIuNTIiIGZvbnQtZmFtaWx5PSJFdmVyIEFmdGVyIiBsZXR0ZXItc3BhY2luZz0iMCIgd29yZC1zcGFjaW5nPSIwIi8+PHBhdGggZmlsbD0iIzk1OTU5NSIgZD0iTTM5OC44NCA2OTEuNjZjLTMuNzItMS4zMy04Ljk2LTUtMTEuNzYtOC4yLTEuNC0xLjYtMi41LTMuMjUtMi41NC0zLjYgNC4yMy02LjA1IDQuNDItNi4zMiA1LjMtNy40NSAzLjMgMy40IDYuNyA2LjggMTAuOSA5LjEgNC45OCAxLjggMTEuMjQgMi4xIDE1LjMyLS4zIDUuNTItMy4zIDguNjItOC44IDkuNjctMTcuMyAxLjQ2LTExLjctMi42NS0yMi41LTEzLjI1LTM0LjgtMi45LTMuNC03LjEzLTguMy05LjM4LTEwLjktNC44Ni01LjYtMTAtMTMuNC0xMS43Ny0xOC41LTQuMy0xMi41LTMuODctMjEuMy0uNjYtMzAuMiAyLjEyLTUuODMgNC45LTkuNiA5LjA4LTEyLjIgOC4yNi01LjE0IDE5LjI4LTQuMjQgMjcuMzYgMi4yNS45LjY4IDEuNyAxLjQ0IDIuNSAyLjU3LS40Ljc3LTMuNyA4Ljc3LTQuMyA4Ljc3LS44LS42Ni0uOC0uNi0xLjYtMS4zLS43LS43LTIuNy0yLjEtNC40LTMuMTQtNC40LTIuMS04LjUtMy4xLTEyLjktLjctNi4xIDMuNDQtOS4yIDExLjctNy45IDIxLjQgMS4xIDguMzQgNC41IDE0IDE3LjkgMjkuNSAxMy4wOCAxNS4yIDE2Ljk1IDIyLjMgMTguOSAzNC42My45IDUuNy45IDEwLjA0IDAgMTYuNi0xLjY1IDEyLjMzLTcuMiAyMC41LTE2LjIgMjMuOTYtMy4zIDEuMy0xNi40NSAxLjMtMjAuMDMuMDR6Ii8+PC9zdmc+" />
            </a>
            <p>
              Backend Engineer at trivago. Likes just-in-time compilers and hot chocolate. <a href="/about">About me.</a>
            </p>
            <nav>
              <ul>
                <li><a href="/">Home</a></li>
                <li><a target="_blank" rel="noopener" href="https://twitter.com/matthiasendler">Twitter</a></li>
                <li><a target="_blank" rel="noopener" href="https://feedly.com/i/subscription/feed/https://matthias-endler.de/rss.xml">RSS</a></li>
              </ul>
            </nav>
        </header>
        <main role="main">
            
              <div class="published-date">
                <i>Published on 10th of December 2017</i>
              </div>
            
              <h1>Making Myself Obsolete</h1>
             <i>&mdash; Writing a Linter for Linting Linters</i>
            <figure>
        <object data="/img/posts/2017/obsolete/dinosaur.svg" type="image/svg+xml"></object>
  <figcaption>
  The Stegosaurus had better days 150 million years ago.<br />
  Paleontologists once thought it had a <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Stegosaurus#.22Second_brain.22">brain in its butt</a>.
  </figcaption>
</figure>
<p>In December 2015 I was looking for static analysis tools to integrate into <a target="_blank" rel="noopener" href="https://tech.trivago.com/">trivago</a>'s CI process.
The idea was to detect typical programming mistakes automatically.
That's quite a common thing, and there are lots of helpful tools out there which fit the bill.</p>
<p>So I looked for a list of tools...</p>
<p>To my surprise, <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis">the only list I found was on Wikipedia</a> — and it was outdated.
There was no such project on Github, where most modern static analysis tools were hosted.</p>
<p>Without overthinking it, I opened up my editor and wrote down a few tools I found through my initial research. After that, I pushed the list to Github.</p>
<p>I called the project <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis/">Awesome Static Analysis</a>.</p>
<p>Fast forward two years and the list has grown quite a bit.
So far, it has 75 contributors, 277 forks and received over 2000 stars. (Thanks for all the support!)
(Update May 2018: 91 contributors, 363 forks, over 3000 stars)</p>
<p>Around 1000 unique visitors find the list every week. Not much by any means, but I feel obliged to keep it up-to-date
because it has become an essential source of information for many people.</p>
<p>It now lists around 300 tools for static analysis. Everything from Ada to TypeScript is on there.
What I find particularly motivating is, that now the authors themselves create pull requests to add their tools!</p>
<p>There was one problem though: The list of pull requests got longer and longer, as I was busy doing other things.</p>
<p><img src="/img/posts/2017/obsolete/pull_requests.jpg" alt="The list of Github Pull requests for awesome-static-analysis" /></p>
<h3>Adding contributors</h3>
<p>I always try to make team members out of regular contributors. My friend and colleague <a target="_blank" rel="noopener" href="https://github.com/andygrunwald">Andy Grunwald</a> as well as <a target="_blank" rel="noopener" href="https://github.com/impredicative">Ouroboros Chrysopoeia</a> are both valuable collaborators. They help me weed out new PRs whenever they find the time.</p>
<p>But let's face it: checking the pull requests is a dull, manual task.
What needs to be checked for each new tool can be summarized like this:</p>
<ul>
<li>Formatting rules are satisfied</li>
<li>Project URL is reachable</li>
<li>License annotation is correct</li>
<li>Tools of each section are alphabetically ordered</li>
<li>Description is not too long</li>
</ul>
<p>I guess it's obvious what we should do with that checklist: automate it!</p>
<h3>A linter for linting linters</h3>
<p>So why not write an analysis tool, which checks our list of analysis tools!
What sounds pretty meta, is actually pretty straightforward.</p>
<p>With every pull request, we trigger our bot, which checks the above rules and responds with a result.</p>
<p>The first step was to read the <a target="_blank" rel="noopener" href="https://developer.github.com/v3/guides/building-a-ci-server/">Github documentation about building a CI server</a>.</p>
<p>Just for fun, I wanted to create the bot in <a target="_blank" rel="noopener" href="https://www.rust-lang.org/">Rust</a>.
The two most popular Github clients for Rust were <a target="_blank" rel="noopener" href="https://github.com/mgattozzi/github-rs">github-rs</a> and <a target="_blank" rel="noopener" href="https://github.com/softprops/hubcaps">hubcaps</a>.
Both looked pretty neat, but then I found <a target="_blank" rel="noopener" href="https://github.com/softprops/afterparty">afterparty</a>, a &quot;Github webhook server&quot;.</p>
<p>The example looked fabulous:</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#a7adba;">#[macro_use]</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">extern</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">crate</span><span style="background-color:#eff1f5;color:#4f5b66;"> log</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">extern</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">crate</span><span style="background-color:#eff1f5;color:#4f5b66;"> env_logger</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">extern</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">crate</span><span style="background-color:#eff1f5;color:#4f5b66;"> afterparty</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">extern</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">crate</span><span style="background-color:#eff1f5;color:#4f5b66;"> hyper</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">use</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">afterparty::</span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">Delivery</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> Hub</span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">use</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">hyper::</span><span style="background-color:#eff1f5;color:#4f5b66;">Server</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#b48ead;">pub</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">fn</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#8fa1b3;">main</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">env_logger::</span><span style="background-color:#eff1f5;color:#4f5b66;">init</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">unwrap</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> addr </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">format!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">0.0.0.0:</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#d08770;">4567</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">mut</span><span style="background-color:#eff1f5;color:#4f5b66;"> hub </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">Hub::</span><span style="background-color:#eff1f5;color:#4f5b66;">new</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">hub.</span><span style="background-color:#eff1f5;color:#96b5b4;">handle</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">pull_request</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">|</span><span style="background-color:#eff1f5;color:#bf616a;">delivery</span><span style="background-color:#eff1f5;color:#4f5b66;">:</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#4f5b66;">Delivery</span><span style="background-color:#eff1f5;color:#4f5b66;">|</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#b48ead;">match</span><span style="background-color:#eff1f5;color:#4f5b66;"> delivery.payload </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">Event::</span><span style="background-color:#eff1f5;color:#4f5b66;">PullRequest </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">ref</span><span style="background-color:#eff1f5;color:#4f5b66;"> action</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">ref</span><span style="background-color:#eff1f5;color:#4f5b66;"> sender</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">..</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">=&gt;</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                </span><span style="background-color:#eff1f5;color:#a7adba;">//</span><span style="background-color:#eff1f5;color:#a7adba;"> TODO: My code here!
</span><span style="background-color:#eff1f5;color:#4f5b66;">                </span><span style="background-color:#eff1f5;color:#4f5b66;">println!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">sender </span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#a3be8c;"> action </span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> sender.login</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> action</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">_</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">=&gt;</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> srvc </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">Server::</span><span style="background-color:#eff1f5;color:#4f5b66;">http</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#4f5b66;">addr</span><span style="background-color:#eff1f5;color:#4f5b66;">[</span><span style="background-color:#eff1f5;color:#4f5b66;">..</span><span style="background-color:#eff1f5;color:#4f5b66;">]</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                   </span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">unwrap</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                   </span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">handle</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">hub</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">println!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">listening on </span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> addr</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">srvc.</span><span style="background-color:#eff1f5;color:#96b5b4;">unwrap</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span></pre>
<p>This allowed me to focus on the actual analysis code,
which makes for a pretty boring read. It mechanically checks for the things mentioned above and could be written in any language.
If you want to have a look (or even contribute!), <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis-ci">check out the repo</a>.</p>
<h3>Talking to Github</h3>
<p>After the analysis code was done, I had a bot, running locally, waiting for incoming pull requests.</p>
<p>But how could I talk to Github?<br />
I found out, that I should use the <a target="_blank" rel="noopener" href="https://developer.github.com/v3/repos/statuses/">Status API</a>
and send a <code>POST</code> request to <code>/repos/mre/awesome-static-analysis/statuses/:sha</code><br />
(<code>:sha</code> is the commit ID that points to the <code>HEAD</code> of the pull request):</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#4f5b66;">{
</span><span style="background-color:#eff1f5;color:#4f5b66;">  </span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;state&quot;: &quot;success&quot;,
</span><span style="background-color:#eff1f5;color:#4f5b66;">  </span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;description&quot;: &quot;The build succeeded!&quot;
</span><span style="background-color:#eff1f5;color:#4f5b66;">}
</span></pre>
<p>I could have used one of the existing Rust Github clients, but I decided to write a simple function to update the pull request status code.</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#b48ead;">fn</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#8fa1b3;">set_status</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#bf616a;">status</span><span style="background-color:#eff1f5;color:#4f5b66;">:</span><span style="background-color:#eff1f5;color:#4f5b66;"> Status, </span><span style="background-color:#eff1f5;color:#bf616a;">desc</span><span style="background-color:#eff1f5;color:#4f5b66;">:</span><span style="background-color:#eff1f5;color:#4f5b66;"> String, </span><span style="background-color:#eff1f5;color:#bf616a;">repo</span><span style="background-color:#eff1f5;color:#4f5b66;">:</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#b48ead;">str</span><span style="background-color:#eff1f5;color:#4f5b66;">, </span><span style="background-color:#eff1f5;color:#bf616a;">sha</span><span style="background-color:#eff1f5;color:#4f5b66;">:</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#b48ead;">str</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">-&gt;</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">Result</span><span style="background-color:#eff1f5;color:#4f5b66;">&lt;</span><span style="background-color:#eff1f5;color:#4f5b66;">reqwest::</span><span style="background-color:#eff1f5;color:#4f5b66;">Response</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt;</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">{</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> token </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">env::</span><span style="background-color:#eff1f5;color:#4f5b66;">var</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">GITHUB_TOKEN</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">?</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> client </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">reqwest::</span><span style="background-color:#eff1f5;color:#4f5b66;">Client::</span><span style="background-color:#eff1f5;color:#4f5b66;">new</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#b48ead;">mut</span><span style="background-color:#eff1f5;color:#4f5b66;"> params </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">HashMap::</span><span style="background-color:#eff1f5;color:#4f5b66;">new</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">params.</span><span style="background-color:#eff1f5;color:#96b5b4;">insert</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">state</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">format!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> status</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">params.</span><span style="background-color:#eff1f5;color:#96b5b4;">insert</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">description</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> desc</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">println!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">Sending status: </span><span style="background-color:#eff1f5;color:#d08770;">{:#?}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> params</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#b48ead;">let</span><span style="background-color:#eff1f5;color:#4f5b66;"> status_url </span><span style="background-color:#eff1f5;color:#4f5b66;">=</span><span style="background-color:#eff1f5;color:#4f5b66;"> </span><span style="background-color:#eff1f5;color:#4f5b66;">format!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">https://api.github.com/repos/</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#a3be8c;">/statuses/</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> repo</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> sha</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">println!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#a3be8c;">Status url: </span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;"> status_url</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">;</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">Ok</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">client
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">request</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">reqwest::</span><span style="background-color:#eff1f5;color:#4f5b66;">Method::</span><span style="background-color:#eff1f5;color:#4f5b66;">Post</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#4f5b66;">format!</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                </span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#a3be8c;">?access_token=</span><span style="background-color:#eff1f5;color:#d08770;">{}</span><span style="background-color:#eff1f5;color:#4f5b66;">&quot;</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                </span><span style="background-color:#eff1f5;color:#4f5b66;">status_url</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">                </span><span style="background-color:#eff1f5;color:#4f5b66;">token</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">            </span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">,</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">json</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;</span><span style="background-color:#eff1f5;color:#4f5b66;">params</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">        </span><span style="background-color:#eff1f5;color:#4f5b66;">.</span><span style="background-color:#eff1f5;color:#96b5b4;">send</span><span style="background-color:#eff1f5;color:#4f5b66;">(</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">?</span><span style="background-color:#eff1f5;color:#4f5b66;">)</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">}</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span></pre>
<p>You can see that I pass in a Github token from the environment and then I send the <code>JSON</code> payload as a post request using the <a target="_blank" rel="noopener" href="https://github.com/seanmonstar/reqwest">reqwest</a> library.</p>
<p>That turned out to become a problem in the end: while afterparty was using version 0.9 of <a target="_blank" rel="noopener" href="https://github.com/hyperium/hyper">hyper</a>, reqwest was using 0.11. Unfortunately, these two versions depend on a different build of the <a target="_blank" rel="noopener" href="https://crates.io/crates/openssl-sys">openssl-sys</a> bindings. That's a <a target="_blank" rel="noopener" href="https://github.com/rust-lang/cargo/issues/886">well-known problem</a> and the only way to fix it, is to resolve the conflict.</p>
<p>I was stuck for a while, but then I saw, that there was an open pull request to <a target="_blank" rel="noopener" href="https://github.com/softprops/afterparty/pull/26">upgrade afterparty to hyper 0.10</a>.</p>
<p>So inside my <code>Cargo.toml</code>, I locked the version of afterparty to the version of the pull request:</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#4f5b66;">[dependencies]
</span><span style="background-color:#eff1f5;color:#4f5b66;">afterparty = { git = &quot;https://github.com/ms705/afterparty&quot; }
</span></pre>
<p>This fixed the build, and I could finally move on.</p>
<h3>Deployment</h3>
<p>I needed a place to host the bot.</p>
<p>Preferably for free, as it was a non-profit Open Source project.
Also, the provider would have to run binaries.</p>
<p>For quite some time, I was following a product named <a target="_blank" rel="noopener" href="https://zeit.co/">zeit</a>.
It runs any Docker container using an intuitive command line interface called <code>now</code>.</p>
<video controls>
  <source src="/img/posts/2017/obsolete/now.mp4" type="video/mp4">
Your browser does not support playing mp4 files.
</video> 
<p>I fell in love the first time I saw their demo on the site, so I wanted to give it a try.</p>
<p>So I added a <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/userguide/eng-image/multistage-build/">multi-stage Dockerfile</a> to my project:</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#4f5b66;">FROM rust as builder
</span><span style="background-color:#eff1f5;color:#4f5b66;">COPY . /usr/src/app 
</span><span style="background-color:#eff1f5;color:#4f5b66;">WORKDIR /usr/src/app 
</span><span style="background-color:#eff1f5;color:#4f5b66;">RUN cargo build --release
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;">FROM debian:stretch
</span><span style="background-color:#eff1f5;color:#4f5b66;">RUN apt update \
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;&amp; apt install -y libssl1.1 ca-certificates \
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;&amp; apt clean -y \
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;&amp; apt autoclean -y \
</span><span style="background-color:#eff1f5;color:#4f5b66;">    </span><span style="background-color:#eff1f5;color:#4f5b66;">&amp;&amp; apt autoremove -y
</span><span style="background-color:#eff1f5;color:#4f5b66;">COPY --from=builder target/release/check .
</span><span style="background-color:#eff1f5;color:#4f5b66;">EXPOSE 4567
</span><span style="background-color:#eff1f5;color:#4f5b66;">ENTRYPOINT [&quot;./check&quot;]
</span><span style="background-color:#eff1f5;color:#4f5b66;">CMD [&quot;--help&quot;]
</span></pre>
<p>The first part would build a static binary, the second part would run it at container startup.
Well, that didn't work, because <code>zeit</code> <a target="_blank" rel="noopener" href="https://github.com/zeit/now-cli/issues/962">does not support multi-stage builds yet</a>.</p>
<p>The workaround was to split up the Dockerfile into two and <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis-ci/blob/master/Makefile">connect them both with a Makefile</a>. Makefiles are pretty powerful, <a href="/2017/makefiles/">you know</a>?</p>
<p>With that, I had all the parts for deployment together.</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#4f5b66;"># Build Rust binary for Linux
</span><span style="background-color:#eff1f5;color:#4f5b66;">docker run --rm -v $(CURDIR):/usr/src/ci -w /usr/src/ci rust cargo build --release
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;"># Deploy Docker images built from the local Dockerfile
</span><span style="background-color:#eff1f5;color:#4f5b66;">now deploy --force --public -e GITHUB_TOKEN=${GITHUB_TOKEN}
</span><span style="background-color:#eff1f5;color:#4f5b66;">
</span><span style="background-color:#eff1f5;color:#4f5b66;"># Set domain name of new build to `check.now.sh`
</span><span style="background-color:#eff1f5;color:#4f5b66;"># (The deployment URL was copied to the clipboard and is retrieved with pbpaste on macOS)
</span><span style="background-color:#eff1f5;color:#4f5b66;">now alias `pbpaste` check.now.sh
</span></pre>
<p>Here's the output of the deploy using <code>now</code>:</p>
<pre style="background-color:#eff1f5">
<span style="background-color:#eff1f5;color:#4f5b66;">&gt; Deploying ~/Code/private/awesome-static-analysis-ci/deploy
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Ready! https://deploy-sjbiykfvtx.now.sh (copied to clipboard) [2s]
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Initializing…
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Initializing…
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Building
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; ▲ docker build
</span><span style="background-color:#eff1f5;color:#4f5b66;">Sending build context to Docker daemon 2.048 kBkB
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Step 1 : FROM mre0/ci:latest
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; latest: Pulling from mre0/ci
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; ...
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Digest: sha256:5ad07c12184755b84ca1b587e91b97c30f7d547e76628645a2c23dc1d9d3fd4b
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Status: Downloaded newer image for mre0/ci:latest
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt;  ---&gt; 8ee1b20de28b
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Successfully built 8ee1b20de28b
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; ▲ Storing image
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; ▲ Deploying image
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; ▲ Container started
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; listening on 0.0.0.0:4567
</span><span style="background-color:#eff1f5;color:#4f5b66;">&gt; Deployment complete!
</span></pre>
<p>The last step was to add <code>check.now.sh</code> as a webhook inside the awesome-static-analysis <a target="_blank" rel="noopener" href="https://developer.github.com/webhooks/creating/">project settings</a>.</p>
<p>Now, whenever a new pull request is coming in, you see that little bot getting active!</p>
<p><img src="/img/posts/2017/obsolete/pull_request_success.jpg" alt="A successful pull request, which was checked by the bot" /></p>
<h3>Outcome and future plans</h3>
<p>I am very pleased with my choice of tools: afterparty saved me from a lot of manual work, while zeit made deployment really easy.<br />
It feels like <a target="_blank" rel="noopener" href="https://aws.amazon.com/lambda/details/">Amazon Lambda</a> on steroids.</p>
<p>If you look at the <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis-ci/blob/master/src/main.rs">code</a> and the <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis-ci/commits/master">commits</a> for my bot, you can see all my little missteps, until I got everything just right. Turns out, parsing human-readable text is tedious.<br />
Therefore I was thinking about turning the list of analysis tools into a structured format like <code>YAML</code>. This would greatly simplify the parsing and have the added benefit of having a machine-readable list of tools that can be used for other projects.</p>
<h3>Update May 2018</h3>
<p>While attending the <a target="_blank" rel="noopener" href="http://wearedevelopers.com/">WeAreDevelopers conference in Vienna</a> (can recommend that), I moved the CI pipeline from <a target="_blank" rel="noopener" href="http://zeit.co/">zeit.co</a> to <a target="_blank" rel="noopener" href="http://travis-ci.org/">Travis CI</a>.
The reason was, that I wanted the linting code next to the project, which greatly simplified things.
First and foremost I don't need the web request handling code anymore, because travis takes care of that.
If you like, you can compare the <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis-ci/blob/master/src/main.rs">old</a> and the <a target="_blank" rel="noopener" href="https://github.com/mre/awesome-static-analysis/blob/master/ci/src/lib.rs">new</a> version.</p>
<ul class="links">
</ul>
        </main>
<footer><form style="border:1px solid #ccc;padding:30px;text-align:center;" action="https://tinyletter.com/mre" method="post" target="popupwindow" 
onsubmit="window.open('https://tinyletter.com/mre', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
    <p><label for="tlemail">Subscribe to newsletter <i style="color: #aaa">(one mail per month)</i></label></p>
    <p>
        <input class="field email" type="email" name="email" id="tlemail" placeholder="E-Mail Address"/>
        <input type="hidden" value="1" name="embed"/><input class="field submit" type="submit" value="Subscribe" />
    </p>
    <p>
    💡 I also <a target="_blank" rel="noopener" href="https://twitter.com/matthiasendler">tweet</a> new articles and have an <a target="_blank" rel="noopener" href="https://feedly.com/i/subscription/feed/https://matthias-endler.de/rss.xml">RSS feed</a>.
    </p>
</form>
    <h3>Continue reading</h3>
    <ul>
        
        
            <li><a href="/2018/cargo-inspect">cargo-inspect</a></li>
        
        
        
            <li><a href="/2018/excel">The Unreasonable Effectiveness of Excel Macros</a></li>
        
        
        
            <li><a href="/2018/keyboard">Switching from a German to a US Keyboard Layout - Is It Worth It?</a></li>
        
        
        
            <li><a href="/2018/fastcat">fastcat - A Faster `cat` Implementation Using Splice</a></li>
        
        
        
            <li><a href="/2018/github">That Octocat on the Wall</a></li>
        
        
    </ul>
</footer>

<script type="text/javascript">
if (location.hostname !== "localhost" && location.hostname !== "127.0.0.1") {
    window.ga=window.ga||function(){(ga.q = ga.q || []).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-693428-1', 'auto');
    ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
  </body>
</html>
